Version 4
SHEET 1 1608 680
WIRE 400 -960 192 -960
WIRE 1280 -960 1072 -960
WIRE 192 -912 192 -960
WIRE 1072 -912 1072 -960
WIRE 192 -864 112 -864
WIRE 1072 -864 992 -864
WIRE 400 -816 400 -960
WIRE 400 -816 384 -816
WIRE 1280 -816 1280 -960
WIRE 1280 -816 1264 -816
WIRE 400 -752 400 -816
WIRE 1280 -752 1280 -816
WIRE 192 -720 192 -768
WIRE 400 -720 400 -752
WIRE 1072 -720 1072 -768
WIRE 1280 -720 1280 -752
WIRE -16 -672 -128 -672
WIRE 128 -672 64 -672
WIRE 864 -672 752 -672
WIRE 1008 -672 944 -672
WIRE -128 -624 -128 -672
WIRE 752 -624 752 -672
WIRE 400 -544 400 -640
WIRE 464 -544 400 -544
WIRE 1280 -544 1280 -640
WIRE 1344 -544 1280 -544
WIRE 400 -512 400 -544
WIRE 1280 -512 1280 -544
WIRE 192 -496 192 -624
WIRE 192 -496 -128 -496
WIRE 464 -496 464 -544
WIRE 464 -496 192 -496
WIRE 1072 -496 1072 -624
WIRE 1072 -496 752 -496
WIRE 1344 -496 1344 -544
WIRE 1344 -496 1072 -496
WIRE 384 -144 176 -144
WIRE 176 -96 176 -144
WIRE 1488 -80 1488 -128
WIRE -1680 -48 -2288 -48
WIRE -592 -16 -784 -16
WIRE 384 0 384 -144
WIRE 384 0 368 0
WIRE 576 0 384 0
WIRE -1840 32 -2032 32
WIRE -592 32 -592 -16
WIRE -1472 48 -1488 48
WIRE -1072 48 -1296 48
WIRE -928 48 -976 48
WIRE -784 48 -784 -16
WIRE -784 48 -848 48
WIRE -1552 64 -1616 64
WIRE -1472 64 -1472 48
WIRE -1296 64 -1296 48
WIRE -1296 64 -1472 64
WIRE 384 64 384 0
WIRE -1840 80 -1840 32
WIRE -1680 80 -1680 -48
WIRE -1616 80 -1616 64
WIRE -1616 80 -1680 80
WIRE -1456 80 -1488 80
WIRE -2176 96 -2224 96
WIRE -2032 96 -2032 32
WIRE -2032 96 -2096 96
WIRE -1072 96 -1072 48
WIRE -976 96 -976 48
WIRE -976 96 -1072 96
WIRE -784 96 -784 48
WIRE -736 96 -784 96
WIRE 176 96 176 48
WIRE 384 96 384 64
WIRE 576 96 576 80
WIRE 704 96 576 96
WIRE -1296 112 -1296 64
WIRE -640 112 -672 112
WIRE -592 112 -640 112
WIRE 1488 112 1488 64
WIRE -896 128 -912 128
WIRE -768 128 -816 128
WIRE -736 128 -768 128
WIRE -2032 144 -2032 96
WIRE -1984 144 -2032 144
WIRE -96 144 -144 144
WIRE -32 144 -96 144
WIRE 112 144 48 144
WIRE 576 144 576 96
WIRE -2144 160 -2192 160
WIRE -1888 160 -1920 160
WIRE -1840 160 -1888 160
WIRE 1216 160 1168 160
WIRE 1280 160 1216 160
WIRE 1424 160 1360 160
WIRE -2144 176 -2144 160
WIRE -2144 176 -2160 176
WIRE -2016 176 -2064 176
WIRE -1984 176 -2016 176
WIRE -2288 192 -2288 -48
WIRE -2192 192 -2192 160
WIRE -2192 192 -2288 192
WIRE -704 192 -704 144
WIRE -688 192 -704 192
WIRE -656 192 -688 192
WIRE -144 192 -144 144
WIRE -1616 208 -1616 80
WIRE -1456 208 -1456 80
WIRE -1456 208 -1616 208
WIRE -688 208 -688 192
WIRE -688 208 -768 208
WIRE 1168 208 1168 160
WIRE -1936 240 -1952 240
WIRE -1904 240 -1936 240
WIRE -720 240 -720 224
WIRE -688 240 -688 208
WIRE -688 240 -720 240
WIRE -512 240 -544 240
WIRE -1936 256 -1936 240
WIRE -1936 256 -2016 256
WIRE -2224 272 -2224 96
WIRE -2224 272 -2288 272
WIRE 384 272 384 176
WIRE 448 272 384 272
WIRE -1968 288 -1968 272
WIRE -1936 288 -1936 256
WIRE -1936 288 -1968 288
WIRE 384 304 384 272
WIRE 176 320 176 192
WIRE 176 320 -144 320
WIRE 448 320 448 272
WIRE 448 320 176 320
WIRE 1488 336 1488 208
WIRE 1488 336 1168 336
WIRE -1376 352 -1488 352
WIRE 704 352 704 96
WIRE 704 352 464 352
WIRE -1552 368 -1616 368
WIRE -1456 384 -1488 384
WIRE -720 384 -720 240
WIRE -528 384 -720 384
WIRE -336 400 -496 400
WIRE -2288 416 -2288 272
WIRE -1616 416 -1616 368
WIRE -1616 416 -2288 416
WIRE -912 416 -912 128
WIRE -832 416 -912 416
WIRE -752 416 -832 416
WIRE -624 416 -752 416
WIRE -560 416 -624 416
WIRE -464 432 -496 432
WIRE -912 448 -912 416
WIRE -336 464 -336 400
WIRE 464 464 464 352
WIRE 464 464 -336 464
WIRE -992 496 -1040 496
WIRE 464 496 464 464
WIRE -1616 512 -1616 416
WIRE -1456 512 -1456 384
WIRE -1456 512 -1616 512
WIRE -1296 512 -1296 192
WIRE -1040 512 -1040 496
WIRE -1040 512 -1296 512
WIRE -624 560 -624 416
WIRE -464 560 -464 432
WIRE -464 560 -624 560
WIRE -1376 640 -1376 352
WIRE -752 640 -752 416
WIRE -752 640 -1376 640
FLAG 576 224 0
FLAG -144 368 0
FLAG 384 304 0
FLAG 176 -144 VLED
FLAG -992 496 0
FLAG 384 64 VBAT
FLAG -704 80 VBAT
FLAG -1296 48 VTEMP
FLAG -640 112 VO1
FLAG -656 192 0
FLAG -528 448 VBAT
FLAG -384 432 0
FLAG -832 416 VREF
FLAG -1520 96 VBAT
FLAG -1520 400 VBAT
FLAG -1888 160 VO2
FLAG -1904 240 0
FLAG -1520 336 0
FLAG -1520 32 0
FLAG -1952 192 0
FLAG -1952 128 VBAT
FLAG -128 -448 0
FLAG 400 -512 0
FLAG 192 -960 VLED
FLAG 400 -752 VBAT
FLAG -128 -672 VO2
FLAG -96 144 VO1
FLAG 112 -864 VBLU
FLAG 1280 -512 0
FLAG 1072 -960 VLED
FLAG 1280 -752 VBAT
FLAG 752 -672 VO2
FLAG 992 -864 VBLU
FLAG 1168 384 0
FLAG 1488 -128 VLED
FLAG 1216 160 VO1
SYMBOL npn 112 96 R0
SYMATTR InstName NPN_R
SYMATTR Value BC847B
SYMBOL voltage 384 80 R0
WINDOW 3 216 311 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(3 3 1m 1m 1m 50m 40m 1)
SYMATTR InstName V2
SYMBOL res 160 -48 R0
SYMATTR InstName R_RED
SYMATTR Value 40
SYMBOL res 64 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 250
SYMBOL res 560 -16 R0
SYMATTR InstName R3
SYMATTR Value 820k
SYMBOL res 560 128 R0
SYMATTR InstName R4
SYMATTR Value 950k
SYMBOL diode 160 -96 R0
SYMATTR InstName REDLED
SYMATTR Value REDLED
SYMBOL res -608 16 R0
SYMATTR InstName R5
SYMATTR Value {Rf}
SYMBOL voltage -1296 96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(1.55 1.66 4m 10m 10m 20m 2 2)
SYMBOL Opamps\\UniversalOpamp2 -704 112 R0
SYMATTR InstName U1
SYMBOL res -752 224 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value {Rf}
SYMBOL res -912 144 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL Opamps\\UniversalOpamp2 -528 416 R180
SYMATTR InstName U2
SYMBOL res -944 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL Opamps\\UniversalOpamp2 -1520 64 R180
SYMATTR InstName U3
SYMBOL Opamps\\UniversalOpamp2 -1520 368 R180
SYMATTR InstName U4
SYMBOL res -1856 64 R0
SYMATTR InstName R9
SYMATTR Value {Rf}
SYMBOL Opamps\\UniversalOpamp2 -1952 160 R0
SYMATTR InstName U5
SYMBOL res -2000 272 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R10
SYMATTR Value {Rf}
SYMBOL res -2160 192 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res -2192 112 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL npn 128 -720 R0
SYMATTR InstName NPN_R1
SYMATTR Value BC847B
SYMBOL res 176 -864 R0
SYMATTR InstName R_BLU
SYMATTR Value 2
SYMBOL res 80 -688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 250
SYMBOL diode 176 -912 R0
SYMATTR InstName BLULED
SYMATTR Value BLULED
SYMBOL npn 1008 -720 R0
SYMATTR InstName NPN_R2
SYMATTR Value BC847B
SYMBOL res 1056 -864 R0
SYMATTR InstName R_BLU1
SYMATTR Value 2
SYMBOL res 960 -688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 250
SYMBOL diode 1056 -912 R0
SYMATTR InstName BLULED1
SYMATTR Value BLULED
SYMBOL npn 1424 112 R0
SYMATTR InstName NPN_R3
SYMATTR Value BC847B
SYMBOL res 1472 -32 R0
SYMATTR InstName R_RED1
SYMATTR Value 40
SYMBOL res 1376 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 250
SYMBOL diode 1472 -80 R0
SYMATTR InstName REDLED1
SYMATTR Value REDLED
TEXT -768 -424 Left 2 !.MODEL REDLED D(Ron=.1 Roff=1Meg Vfwd=2.1)\n.MODEL BLULED D(Ron=.1 Roff=1Meg Vfwd=2.9)
TEXT -768 -392 Left 2 !.tran 80m
TEXT -784 -352 Left 2 !.inc opamp.sub
TEXT -776 -264 Left 2 !.param Rf=500k
